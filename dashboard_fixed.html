<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Code Optimizer - Live Dashboard</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #0f172a;
            color: #e2e8f0;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        h1 {
            color: #60a5fa;
            margin-bottom: 10px;
        }
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .card {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border-radius: 12px;
            padding: 24px;
            border: 1px solid #475569;
        }
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: #60a5fa;
            margin: 10px 0;
        }
        .metric-label {
            color: #94a3b8;
            font-size: 0.875rem;
        }
        .progress-bar {
            background: #1e293b;
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
            margin: 15px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #34d399 100%);
            transition: width 0.3s ease;
        }
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: bold;
        }
        .status-active {
            background: #10b981;
            color: white;
        }
        .status-inactive {
            background: #6b7280;
            color: white;
        }
        .danger { background: linear-gradient(90deg, #dc2626 0%, #ef4444 100%); }
        .warning { background: linear-gradient(90deg, #f59e0b 0%, #fbbf24 100%); }
        .safe { background: linear-gradient(90deg, #10b981 0%, #34d399 100%); }
        .update-time {
            text-align: center;
            color: #6b7280;
            font-size: 0.875rem;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Claude Code Optimizer Dashboard</h1>
        <div id="status"></div>
    </div>
    
    <div class="dashboard-grid">
        <div class="card">
            <div class="metric-label">Current Session</div>
            <div class="metric-value" id="sessionId">Loading...</div>
            <div id="sessionStatus"></div>
        </div>
        
        <div class="card">
            <div class="metric-label">Real Tokens Used</div>
            <div class="metric-value" id="realTokens">0</div>
            <div class="metric-label">Billable: <span id="billableTokens">0</span></div>
        </div>
        
        <div class="card">
            <div class="metric-label">Weekly Usage</div>
            <div class="metric-value" id="weeklyUsage">0%</div>
            <div class="progress-bar">
                <div class="progress-fill" id="weeklyProgress" style="width: 0%"></div>
            </div>
        </div>
        
        <div class="card">
            <div class="metric-label">5-Hour Block</div>
            <div class="metric-value" id="blockUsage">0%</div>
            <div class="progress-bar">
                <div class="progress-fill" id="blockProgress" style="width: 0%"></div>
            </div>
        </div>
    </div>
    
    <div class="update-time" id="updateTime">Last updated: Never</div>
    
    <script>
        // Embedded data
        const EMBEDDED_DATA = {
            sessionData: {"sessionData": {"activeSessionId": "cc_session_20250816_222413", "sessionType": "claude-code", "startTime": "2025-08-16T21:37:00", "endTime": null, "inputTokens": 0, "outputTokens": 0, "realTokens": 0, "billableTokens": 15000, "modelUsed": "Unknown", "isActive": true, "costEstimate": 0.045, "cacheCreationTokens": 0, "cacheReadTokens": 0, "totalCacheTokens": 0, "globalTotals": {"totalRealTokens": 1309402, "totalBillableTokens": 15000, "totalCost": 0.0, "totalSessions": 7}}, "lastUpdate": "2025-08-16T23:16:54.899011", "dataSource": "main_database"},
            rateLimitData: {"fiveHourLimit": {"usage_percentage": 0, "total_tokens": 0, "billable_tokens": 0, "time_remaining_minutes": 300, "limit_tokens": 200000, "is_complete": false}, "weeklyLimit": {"usage_percentage": 1.5, "total_tokens": 1309402, "billable_tokens": 15000, "total_sessions": 7, "days_remaining": 0, "limit_tokens": 1000000}}
        };
        
        function updateDashboard() {
            const session = EMBEDDED_DATA.sessionData.sessionData;
            const limits = EMBEDDED_DATA.rateLimitData;
            
            // Update session info
            document.getElementById('sessionId').textContent = 
                session.activeSessionId ? session.activeSessionId.substring(0, 30) + '...' : 'No active session';
            
            // Update status
            const statusEl = document.getElementById('sessionStatus');
            if (session.isActive) {
                statusEl.innerHTML = '<span class="status-badge status-active">ACTIVE</span>';
            } else {
                statusEl.innerHTML = '<span class="status-badge status-inactive">INACTIVE</span>';
            }
            
            // Update tokens
            document.getElementById('realTokens').textContent = 
                (session.realTokens || 0).toLocaleString();
            document.getElementById('billableTokens').textContent = 
                (session.billableTokens || 0).toLocaleString();
            
            // Update weekly usage
            const weeklyPercentage = limits.weeklyLimit.usage_percentage || 0;
            document.getElementById('weeklyUsage').textContent = weeklyPercentage.toFixed(1) + '%';
            document.getElementById('weeklyProgress').style.width = weeklyPercentage + '%';
            
            // Color code weekly progress
            const weeklyBar = document.getElementById('weeklyProgress');
            if (weeklyPercentage >= 90) {
                weeklyBar.className = 'progress-fill danger';
            } else if (weeklyPercentage >= 70) {
                weeklyBar.className = 'progress-fill warning';
            } else {
                weeklyBar.className = 'progress-fill safe';
            }
            
            // Update 5-hour block
            const blockPercentage = limits.fiveHourLimit.usage_percentage || 0;
            document.getElementById('blockUsage').textContent = blockPercentage.toFixed(1) + '%';
            document.getElementById('blockProgress').style.width = blockPercentage + '%';
            
            // Color code block progress
            const blockBar = document.getElementById('blockProgress');
            if (blockPercentage >= 90) {
                blockBar.className = 'progress-fill danger';
            } else if (blockPercentage >= 70) {
                blockBar.className = 'progress-fill warning';
            } else {
                blockBar.className = 'progress-fill safe';
            }
            
            // Update time
            document.getElementById('updateTime').textContent = 
                'Last updated: ' + new Date(EMBEDDED_DATA.sessionData.lastUpdate).toLocaleString();
        }
        
        // Initialize dashboard
        updateDashboard();
    </script>
</body>
</html>