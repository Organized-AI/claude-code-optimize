<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Code Rate Limit Tracker 🔥</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
            min-height: 100vh;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #60a5fa;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .live-indicator {
            background: linear-gradient(45deg, #10b981, #34d399);
            color: white;
            padding: 8px 16px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: bold;
            display: inline-block;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .rate-limit-card {
            background: linear-gradient(135deg, #1e293b, #334155);
            border-radius: 12px;
            padding: 25px;
            border: 2px solid #3b82f6;
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.2);
        }
        
        .rate-limit-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .rate-limit-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #60a5fa;
        }
        
        .rate-limit-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .status-safe { background: #166534; color: #4ade80; }
        .status-warning { background: #92400e; color: #fbbf24; }
        .status-danger { background: #991b1b; color: #f87171; }
        
        .progress-container {
            background: #0f172a;
            border-radius: 8px;
            height: 20px;
            margin: 15px 0;
            overflow: hidden;
            position: relative;
        }
        
        .progress-bar {
            height: 100%;
            border-radius: 8px;
            transition: width 0.5s ease;
            position: relative;
        }
        
        .progress-safe { background: linear-gradient(90deg, #10b981, #34d399); }
        .progress-warning { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
        .progress-danger { background: linear-gradient(90deg, #ef4444, #f87171); }
        
        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 12px;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
        }
        
        .usage-stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        .stat-item {
            text-align: center;
            padding: 12px;
            background: #0f172a;
            border-radius: 8px;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #10b981;
        }
        
        .stat-label {
            font-size: 12px;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 5px;
        }
        
        .real-data-card {
            background: linear-gradient(135deg, #1e293b, #334155);
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
            border: 2px solid #10b981;
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.2);
            grid-column: 1 / -1;
        }
        
        .token-display {
            text-align: center;
            padding: 20px;
        }
        
        .token-count {
            font-size: 3rem;
            font-weight: bold;
            color: #10b981;
            text-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
            margin: 20px 0;
        }
        
        .refresh-btn {
            background: linear-gradient(45deg, #3b82f6, #1d4ed8);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin: 20px auto;
            display: block;
            transition: transform 0.2s;
        }
        
        .refresh-btn:hover {
            transform: scale(1.05);
        }
        
        .plan-info {
            background: #0f172a;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #60a5fa;
        }
        
        .time-remaining {
            font-size: 1.1rem;
            font-weight: bold;
            color: #34d399;
        }

        .debug-info {
            background: #0f172a;
            padding: 10px;
            border-radius: 6px;
            margin-top: 15px;
            font-size: 12px;
            color: #10b981;
            border-left: 3px solid #10b981;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Claude Code Rate Limit Tracker</h1>
        <div class="live-indicator">🔥 REAL-TIME MONITORING</div>
    </div>

    <div class="plan-info">
        <strong>Plan:</strong> Max 5x Pro ($100/month) • 
        <strong>Model Access:</strong> Sonnet + Opus • 
        <strong>Reset:</strong> Every 5 hours & Weekly
    </div>

    <div class="dashboard-grid">
        <!-- 5-Hour Session Limit -->
        <div class="rate-limit-card">
            <div class="rate-limit-header">
                <div class="rate-limit-title">5-Hour Session Limit</div>
                <div class="rate-limit-status" id="fiveHourStatus">SAFE</div>
            </div>
            
            <div class="progress-container">
                <div class="progress-bar" id="fiveHourProgress">
                    <div class="progress-text" id="fiveHourText">0%</div>
                </div>
            </div>
            
            <div class="time-remaining">
                Next Reset: <span id="fiveHourReset">Loading...</span>
            </div>
            
            <div class="usage-stats">
                <div class="stat-item">
                    <div class="stat-value" id="fiveHourTokens">0</div>
                    <div class="stat-label">Tokens Used</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="fiveHourPrompts">0</div>
                    <div class="stat-label">Prompts</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="fiveHourRemaining">100%</div>
                    <div class="stat-label">Remaining</div>
                </div>
            </div>
        </div>

        <!-- Weekly Session Limit -->
        <div class="rate-limit-card">
            <div class="rate-limit-header">
                <div class="rate-limit-title">Weekly Limit</div>
                <div class="rate-limit-status" id="weeklyStatus">SAFE</div>
            </div>
            
            <div class="progress-container">
                <div class="progress-bar" id="weeklyProgress">
                    <div class="progress-text" id="weeklyText">0%</div>
                </div>
            </div>
            
            <div class="time-remaining">
                Week Ends: <span id="weeklyReset">Loading...</span>
            </div>
            
            <div class="usage-stats">
                <div class="stat-item">
                    <div class="stat-value" id="weeklyTokens">0</div>
                    <div class="stat-label">Total Tokens</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="weeklySessions">0</div>
                    <div class="stat-label">Sessions</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="weeklyRemaining">100%</div>
                    <div class="stat-label">Remaining</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Real Token Data Display -->
    <div class="real-data-card">
        <div class="token-display">
            <div class="stat-label">Latest Session Token Count</div>
            <div class="token-count" id="tokenCount">Loading...</div>
            <div class="stat-label">Session ID: <span id="sessionId">Loading...</span></div>
        </div>
        
        <button class="refresh-btn" onclick="loadEmbeddedData()">🔄 Refresh Rate Limits</button>
        
        <div class="debug-info" id="debugInfo">
            Using embedded data (no CORS issues)
        </div>
        
        <div style="text-align: center; color: #64748b; margin-top: 15px;">
            Last updated: <span id="lastUpdate">Loading...</span>
        </div>
    </div>

    <script>
        // Embedded data to avoid CORS issues with file:// protocol
        const EMBEDDED_RATE_DATA = {
        "plan_type": "max_5x",
        "plan_name": "Max 5x Pro ($100/month)",
        "five_hour_block": {
                "period_start": "2025-08-14T15:00:00",
                "period_end": "2025-08-14T20:00:00",
                "total_tokens": 0,
                "total_prompts": 0,
                "weighted_prompts": 0,
                "usage_percentage": 0.0,
                "token_percentage": 0.0,
                "prompt_percentage": 0.0,
                "sessions_count": 0,
                "model_breakdown": {},
                "limits": {
                        "max_prompts": 150,
                        "max_tokens": 300000,
                        "sonnet_weight": 1.0,
                        "opus_weight": 2.5
                },
                "time_remaining_minutes": 168,
                "status": "safe"
        },
        "weekly_limit": {
                "period_start": "2025-08-11T00:00:00",
                "period_end": "2025-08-18T00:00:00",
                "total_tokens": 1304152,
                "total_sessions": 1,
                "total_prompts": 356,
                "usage_percentage": 65.2076,
                "token_percentage": 65.2076,
                "session_percentage": 0.1,
                "model_breakdown": {
                        "sonnet": 356,
                        "opus": 0
                },
                "daily_breakdown": {
                        "2025-08-14": {
                                "tokens": 1304152,
                                "prompts": 356,
                                "sessions": 1
                        }
                },
                "limits": {
                        "max_prompts": 1000,
                        "max_tokens": 2000000,
                        "sonnet_hours": 280,
                        "opus_hours": 35
                },
                "days_remaining": 4,
                "status": "safe"
        },
        "last_updated": "2025-08-14T17:11:28.659013",
        "overall_status": "safe"
};
        const EMBEDDED_SESSION_DATA = {
        "isActive": false,
        "totalActiveSessions": 0,
        "lastUpdated": "2025-08-14T16:59:07.005682",
        "activeSessionId": "bbd41f5f-33e1-43d8-9e4e-3534b49a6722",
        "realTokens": 1304152,
        "sessionType": "claude_code"
};
        
        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toString();
        }
        
        function getProgressColor(percentage) {
            if (percentage < 70) return 'safe';
            if (percentage < 90) return 'warning';
            return 'danger';
        }
        
        function getStatusText(percentage) {
            if (percentage < 70) return 'SAFE';
            if (percentage < 90) return 'WARNING';
            return 'DANGER';
        }
        
        function updateProgressBar(elementId, percentage, type) {
            const progressBar = document.getElementById(elementId);
            const progressText = document.getElementById(elementId.replace('Progress', 'Text'));
            const statusElement = document.getElementById(elementId.replace('Progress', 'Status'));
            
            const color = getProgressColor(percentage);
            const status = getStatusText(percentage);
            
            progressBar.className = ;
            progressBar.style.width = ;
            progressText.textContent = ;
            
            statusElement.className = ;
            statusElement.textContent = status;
        }
        
        function loadEmbeddedData() {
            const debugInfo = document.getElementById('debugInfo');
            
            try {
                const rateLimitData = EMBEDDED_RATE_DATA;
                const sessionData = EMBEDDED_SESSION_DATA;
                
                console.log('Loading embedded data...', rateLimitData);
                
                // Update 5-hour block progress
                const fiveHour = rateLimitData.five_hour_block;
                updateProgressBar('fiveHourProgress', fiveHour.usage_percentage, 'fiveHour');
                
                document.getElementById('fiveHourTokens').textContent = formatNumber(fiveHour.total_tokens);
                document.getElementById('fiveHourPrompts').textContent = fiveHour.total_prompts;
                document.getElementById('fiveHourRemaining').textContent = ;
                
                // Update weekly progress
                const weekly = rateLimitData.weekly_limit;
                updateProgressBar('weeklyProgress', weekly.usage_percentage, 'weekly');
                
                document.getElementById('weeklyTokens').textContent = formatNumber(weekly.total_tokens);
                document.getElementById('weeklySessions').textContent = weekly.total_sessions;
                document.getElementById('weeklyRemaining').textContent = ;
                
                // Update time remaining
                const fiveHourMinutes = fiveHour.time_remaining_minutes;
                const fiveHourHours = Math.floor(fiveHourMinutes / 60);
                const fiveHourMins = fiveHourMinutes % 60;
                document.getElementById('fiveHourReset').textContent = ;
                
                const weeklyDays = weekly.days_remaining;
                document.getElementById('weeklyReset').textContent = ;
                
                // Update main token display
                const realTokens = sessionData.realTokens || 0;
                const sessionId = sessionData.activeSessionId || 'N/A';
                
                document.getElementById('tokenCount').textContent = formatNumber(realTokens);
                document.getElementById('sessionId').textContent = sessionId.length > 16 ? sessionId.substring(0, 16) + '...' : sessionId;
                
                document.getElementById('lastUpdate').textContent = new Date().toLocaleString();
                
                // Update debug info
                debugInfo.innerHTML = ;
                
                console.log('✅ Dashboard updated successfully with embedded data');
                
            } catch (error) {
                console.error('❌ Error loading embedded data:', error);
                debugInfo.innerHTML = ;
            }
        }
        
        // Load data on page load
        loadEmbeddedData();
        
        // Note: No auto-refresh since data is embedded
        // In a real implementation, you'd periodically regenerate this file
    </script>
</body>
</html>