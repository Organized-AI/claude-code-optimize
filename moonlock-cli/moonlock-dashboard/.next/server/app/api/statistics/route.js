"use strict";(()=>{var e={};e.id=198,e.ids=[198],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1017:e=>{e.exports=require("path")},1313:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>g,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>f});var s={};r.r(s),r.d(s,{GET:()=>p,dynamic:()=>c,revalidate:()=>l});var a=r(9303),o=r(8716),i=r(670),n=r(7070),u=r(6607);let c="force-dynamic",l=0;async function p(){try{let e=await (0,u.aC)();return n.NextResponse.json(e)}catch(e){return console.error("Error in statistics API:",e),n.NextResponse.json({error:"Failed to fetch statistics"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/statistics/route",pathname:"/api/statistics",filename:"route",bundlePath:"app/api/statistics/route"},resolvedPagePath:"/Users/jordaaan/Library/Mobile Documents/com~apple~CloudDocs/BHT Promo iCloud/Organized AI/Windsurf/Claude Code Optimizer/moonlock-cli/moonlock-dashboard/app/api/statistics/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:h}=d,y="/api/statistics/route";function g(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:f})}},6607:(e,t,r)=>{r.d(t,{s$:()=>p,y4:()=>d,Rx:()=>c,aC:()=>m,zE:()=>l});let s=require("fs");var a=r(1017),o=r.n(a);let i=require("os");var n=r.n(i);let u=()=>{let e=n().homedir();return o().join(e,".moonlock")};async function c(){try{let e=u(),t=o().join(e,"sessions");try{await s.promises.access(t)}catch{return[]}let r=await s.promises.readdir(t),a=[];for(let e of r)if(e.endsWith(".json"))try{let r=o().join(t,e),i=await s.promises.readFile(r,"utf-8"),n=JSON.parse(i);a.push(n)}catch(t){console.error(`Error reading session file ${e}:`,t)}return a.sort((e,t)=>new Date(t.lastUsed).getTime()-new Date(e.lastUsed).getTime()),a}catch(e){return console.error("Error reading sessions:",e),[]}}async function l(e){try{let t=u(),r=o().join(t,"tokens");try{await s.promises.access(r)}catch{return[]}let a=await s.promises.readdir(r),i=[];for(let t of a)if(t.endsWith(".json")){if(e&&!t.includes(e))continue;try{let e=o().join(r,t),a=await s.promises.readFile(e,"utf-8"),n=JSON.parse(a);Array.isArray(n)?i.push(...n):i.push(n)}catch(e){console.error(`Error reading token file ${t}:`,e)}}return i.sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()),i}catch(e){return console.error("Error reading token usage:",e),[]}}async function p(){try{let e=u(),t=o().join(e,"active-session"),r=await s.promises.readFile(t,"utf-8");return JSON.parse(r)}catch(e){return null}}async function d(e){try{let t=u(),r=o().join(t,"sessions",`${e}.json`),a=await s.promises.readFile(r,"utf-8");return JSON.parse(a)}catch(t){return console.error(`Error reading session ${e}:`,t),null}}async function m(){let e=await c(),t=await l(),r=e.length,s=e.filter(e=>"active"===e.status).length,a=t.reduce((e,t)=>e+t.total,0),o=new Date;o.setHours(0,0,0,0);let i=t.filter(e=>new Date(e.timestamp)>=o).reduce((e,t)=>e+t.total,0),n=new Date;return n.setDate(1),n.setHours(0,0,0,0),{totalSessions:r,activeSessions:s,totalTokens:a,todayUsage:i,monthlyUsage:t.filter(e=>new Date(e.timestamp)>=n).reduce((e,t)=>e+t.total,0),providerUsage:t.reduce((e,t)=>{let r=t.provider||"unknown";return e[r]||(e[r]={input:0,output:0,total:0}),e[r].input+=t.input,e[r].output+=t.output,e[r].total+=t.total,e},{})}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,972],()=>r(1313));module.exports=s})();