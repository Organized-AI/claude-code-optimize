"use strict";(()=>{var e={};e.id=772,e.ids=[772],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1017:e=>{e.exports=require("path")},2755:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>w,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>f});var s={};r.r(s),r.d(s,{GET:()=>p,dynamic:()=>l,revalidate:()=>c});var o=r(9303),n=r(8716),a=r(670),i=r(7070),u=r(6607);let l="force-dynamic",c=0;async function p(e){try{let{searchParams:t}=new URL(e.url),r=t.get("id");if(r){let e=await (0,u.y4)(r);if(!e)return i.NextResponse.json({error:"Session not found"},{status:404});return i.NextResponse.json(e)}let s=await (0,u.Rx)();return i.NextResponse.json(s)}catch(e){return console.error("Error in sessions API:",e),i.NextResponse.json({error:"Failed to fetch sessions"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/sessions/route",pathname:"/api/sessions",filename:"route",bundlePath:"app/api/sessions/route"},resolvedPagePath:"/Users/jordaaan/Library/Mobile Documents/com~apple~CloudDocs/BHT Promo iCloud/Organized AI/Windsurf/Claude Code Optimizer/moonlock-cli/moonlock-dashboard/app/api/sessions/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:h}=d,y="/api/sessions/route";function w(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:f})}},6607:(e,t,r)=>{r.d(t,{s$:()=>p,y4:()=>d,Rx:()=>l,aC:()=>m,zE:()=>c});let s=require("fs");var o=r(1017),n=r.n(o);let a=require("os");var i=r.n(a);let u=()=>{let e=i().homedir();return n().join(e,".moonlock")};async function l(){try{let e=u(),t=n().join(e,"sessions");try{await s.promises.access(t)}catch{return[]}let r=await s.promises.readdir(t),o=[];for(let e of r)if(e.endsWith(".json"))try{let r=n().join(t,e),a=await s.promises.readFile(r,"utf-8"),i=JSON.parse(a);o.push(i)}catch(t){console.error(`Error reading session file ${e}:`,t)}return o.sort((e,t)=>new Date(t.lastUsed).getTime()-new Date(e.lastUsed).getTime()),o}catch(e){return console.error("Error reading sessions:",e),[]}}async function c(e){try{let t=u(),r=n().join(t,"tokens");try{await s.promises.access(r)}catch{return[]}let o=await s.promises.readdir(r),a=[];for(let t of o)if(t.endsWith(".json")){if(e&&!t.includes(e))continue;try{let e=n().join(r,t),o=await s.promises.readFile(e,"utf-8"),i=JSON.parse(o);Array.isArray(i)?a.push(...i):a.push(i)}catch(e){console.error(`Error reading token file ${t}:`,e)}}return a.sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()),a}catch(e){return console.error("Error reading token usage:",e),[]}}async function p(){try{let e=u(),t=n().join(e,"active-session"),r=await s.promises.readFile(t,"utf-8");return JSON.parse(r)}catch(e){return null}}async function d(e){try{let t=u(),r=n().join(t,"sessions",`${e}.json`),o=await s.promises.readFile(r,"utf-8");return JSON.parse(o)}catch(t){return console.error(`Error reading session ${e}:`,t),null}}async function m(){let e=await l(),t=await c(),r=e.length,s=e.filter(e=>"active"===e.status).length,o=t.reduce((e,t)=>e+t.total,0),n=new Date;n.setHours(0,0,0,0);let a=t.filter(e=>new Date(e.timestamp)>=n).reduce((e,t)=>e+t.total,0),i=new Date;return i.setDate(1),i.setHours(0,0,0,0),{totalSessions:r,activeSessions:s,totalTokens:o,todayUsage:a,monthlyUsage:t.filter(e=>new Date(e.timestamp)>=i).reduce((e,t)=>e+t.total,0),providerUsage:t.reduce((e,t)=>{let r=t.provider||"unknown";return e[r]||(e[r]={input:0,output:0,total:0}),e[r].input+=t.input,e[r].output+=t.output,e[r].total+=t.total,e},{})}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,972],()=>r(2755));module.exports=s})();