(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2665:function(e,s,t){Promise.resolve().then(t.bind(t,6596))},6596:function(e,s,t){"use strict";t.d(s,{Dashboard:function(){return k}});var a=t(7437),l=t(2265),r=t(6235),n=t(4207),o=t(5353),i=t(933),c=t(969);function d(e){let{session:s,isActive:t}=e;return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 ".concat(t?"border-green-500":"border-gray-300"," hover:shadow-lg transition-shadow"),children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:s.projectPath})]}),(0,a.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat({active:"bg-green-100 text-green-800 border-green-200",paused:"bg-yellow-100 text-yellow-800 border-yellow-200",completed:"bg-gray-100 text-gray-800 border-gray-200"}[s.status]),children:[t&&(0,a.jsx)(n.Z,{className:"inline w-3 h-3 mr-1"}),s.status]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,a.jsxs)("span",{children:[s.provider," / ",s.model]})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(i.Z,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,a.jsx)("span",{children:(0,r.WU)(new Date(s.lastUsed),"MMM d, HH:mm")})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(c.Z,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Tokens:"})]}),(0,a.jsxs)("div",{className:"flex gap-4 text-sm",children:[(0,a.jsxs)("span",{className:"text-blue-600",children:["In: ",s.tokenUsage.input.toLocaleString()]}),(0,a.jsxs)("span",{className:"text-green-600",children:["Out: ",s.tokenUsage.output.toLocaleString()]}),(0,a.jsxs)("span",{className:"font-semibold text-gray-900",children:["Total: ",s.tokenUsage.total.toLocaleString()]})]})]}),s.metadata&&(0,a.jsxs)("div",{className:"mt-3 flex gap-2",children:[s.metadata.language&&(0,a.jsx)("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded",children:s.metadata.language}),s.metadata.framework&&(0,a.jsx)("span",{className:"px-2 py-1 bg-purple-50 text-purple-700 text-xs rounded",children:s.metadata.framework})]})]})}function x(e){let{title:s,value:t,subtitle:l,icon:r,trend:n}=e;return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:s}),(0,a.jsx)("p",{className:"mt-2 text-3xl font-semibold text-gray-900",children:t}),l&&(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:l}),n&&(0,a.jsxs)("div",{className:"mt-2 flex items-center text-sm",children:[(0,a.jsxs)("span",{className:"font-medium ".concat(n.isPositive?"text-green-600":"text-red-600"),children:[n.isPositive?"+":"-",Math.abs(n.value),"%"]}),(0,a.jsx)("span",{className:"ml-2 text-gray-500",children:"from yesterday"})]})]}),(0,a.jsx)("div",{className:"ml-4 p-3 bg-moonlock-50 rounded-lg",children:r})]})})}var m=t(5231),h=t(8148),g=t(4142),u=t(2842),j=t(9542),p=t(5475),b=t(153),y=t(6638);function N(e){let{sessionId:s}=e,[t,n]=(0,l.useState)([]),[o,i]=(0,l.useState)(!0);return((0,l.useEffect)(()=>{let e=async()=>{try{let e=await fetch(s?"/api/tokens?sessionId=".concat(s):"/api/tokens"),t=(await e.json()).reduce((e,s)=>{let t=(0,r.WU)(new Date(s.timestamp),"MMM dd");return e[t]||(e[t]={date:t,input:0,output:0,total:0}),e[t].input+=s.input,e[t].output+=s.output,e[t].total+=s.total,e},{}),a=Object.values(t).slice(-7);n(a)}catch(e){console.error("Error fetching token usage:",e)}finally{i(!1)}};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[s]),o)?(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),(0,a.jsx)("div",{className:"h-64 bg-gray-100 rounded"})]})}):(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Token Usage Trend"}),(0,a.jsx)(m.h,{width:"100%",height:300,children:(0,a.jsxs)(h.w,{data:t,children:[(0,a.jsx)(g.q,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),(0,a.jsx)(u.K,{dataKey:"date",stroke:"#6b7280"}),(0,a.jsx)(j.B,{stroke:"#6b7280"}),(0,a.jsx)(p.u,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb"},labelStyle:{color:"#111827"}}),(0,a.jsx)(b.D,{}),(0,a.jsx)(y.x,{type:"monotone",dataKey:"input",stroke:"#3b82f6",strokeWidth:2,name:"Input Tokens",dot:{fill:"#3b82f6",r:4}}),(0,a.jsx)(y.x,{type:"monotone",dataKey:"output",stroke:"#10b981",strokeWidth:2,name:"Output Tokens",dot:{fill:"#10b981",r:4}}),(0,a.jsx)(y.x,{type:"monotone",dataKey:"total",stroke:"#8b5cf6",strokeWidth:2,name:"Total",dot:{fill:"#8b5cf6",r:4}})]})})]})}var f=t(6706),v=t(3225),w=t(1568);function k(){let[e,s]=(0,l.useState)([]),[t,r]=(0,l.useState)(null),[o,m]=(0,l.useState)(null),[h,g]=(0,l.useState)(!0),[u,j]=(0,l.useState)("active"),[p,b]=(0,l.useState)(!1),y=async()=>{try{b(!0);let[e,t,a]=await Promise.all([fetch("/api/sessions"),fetch("/api/active-session"),fetch("/api/statistics")]),l=await e.json(),n=await t.json(),o=await a.json();s(l),r(n),m(o)}catch(e){console.error("Error fetching data:",e)}finally{g(!1),b(!1)}};(0,l.useEffect)(()=>{y();let e=setInterval(y,1e4);return()=>clearInterval(e)},[]);let k=e.filter(e=>"active"===e.status),S=e.filter(e=>"active"!==e.status);return h?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-moonlock-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading dashboard..."})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Moonlock Dashboard"}),(0,a.jsx)("span",{className:"ml-4 px-2 py-1 bg-moonlock-100 text-moonlock-700 text-xs rounded-full",children:"Real-time Data"})]}),(0,a.jsxs)("button",{onClick:y,disabled:p,className:"flex items-center gap-2 px-4 py-2 bg-moonlock-600 text-white rounded-lg hover:bg-moonlock-700 disabled:opacity-50 transition-colors",children:[(0,a.jsx)(f.Z,{className:"w-4 h-4 ".concat(p?"animate-spin":"")}),"Refresh"]})]})})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,a.jsx)(x,{title:"Active Sessions",value:o.activeSessions,subtitle:"of ".concat(o.totalSessions," total"),icon:(0,a.jsx)(n.Z,{className:"w-6 h-6 text-moonlock-600"})}),(0,a.jsx)(x,{title:"Today's Tokens",value:o.todayUsage.toLocaleString(),icon:(0,a.jsx)(i.Z,{className:"w-6 h-6 text-moonlock-600"})}),(0,a.jsx)(x,{title:"Monthly Usage",value:o.monthlyUsage.toLocaleString(),icon:(0,a.jsx)(v.Z,{className:"w-6 h-6 text-moonlock-600"})}),(0,a.jsx)(x,{title:"Total Tokens",value:o.totalTokens.toLocaleString(),icon:(0,a.jsx)(c.Z,{className:"w-6 h-6 text-moonlock-600"})})]}),(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsx)(N,{})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow mb-6",children:(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsxs)("nav",{className:"flex -mb-px",children:[(0,a.jsxs)("button",{onClick:()=>j("active"),className:"py-4 px-6 text-sm font-medium border-b-2 transition-colors ".concat("active"===u?"border-moonlock-600 text-moonlock-600":"border-transparent text-gray-500 hover:text-gray-700"),children:[(0,a.jsx)(n.Z,{className:"inline w-4 h-4 mr-2"}),"Active Sessions (",k.length,")"]}),(0,a.jsxs)("button",{onClick:()=>j("history"),className:"py-4 px-6 text-sm font-medium border-b-2 transition-colors ".concat("history"===u?"border-moonlock-600 text-moonlock-600":"border-transparent text-gray-500 hover:text-gray-700"),children:[(0,a.jsx)(w.Z,{className:"inline w-4 h-4 mr-2"}),"History (",S.length,")"]})]})})}),(0,a.jsx)("div",{className:"space-y-4",children:"active"===u?k.length>0?k.map(e=>(0,a.jsx)(d,{session:e,isActive:(null==t?void 0:t.sessionId)===e.id},e.id)):(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[(0,a.jsx)(n.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No active sessions"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"Start a new session using the Moonlock CLI"})]}):S.length>0?S.map(e=>(0,a.jsx)(d,{session:e},e.id)):(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[(0,a.jsx)(w.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No session history"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"Completed sessions will appear here"})]})})]})]})}}},function(e){e.O(0,[259,971,23,744],function(){return e(e.s=2665)}),_N_E=e.O()}]);