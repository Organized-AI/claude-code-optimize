# Visual Architecture: Native Workflows

## ğŸ¯ The Complete System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CLAUDE CODE OPTIMIZER v2.0                      â”‚
â”‚                        Native Workflows Edition                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. INITIALIZATION  â”‚
â”‚  (One-time setup)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ User runs:  â”‚
    â”‚ /analyze-   â”‚
    â”‚  project    â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Rule-Based TypeScript Analyzer          â”‚
â”‚  â€¢ Scans files recursively               â”‚
â”‚  â€¢ Calculates complexity (heuristics)    â”‚
â”‚  â€¢ Estimates hours (formulas)            â”‚
â”‚  â€¢ Generates phases                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                 â”‚                  â”‚
           â–¼                 â–¼                  â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  CLAUDE.md  â”‚   â”‚ session-     â”‚   â”‚ Specialized â”‚
  â”‚             â”‚   â”‚ plan.json    â”‚   â”‚ Agents      â”‚
  â”‚ Project     â”‚   â”‚              â”‚   â”‚             â”‚
  â”‚ guidance    â”‚   â”‚ Phase specs  â”‚   â”‚ 4 .md files â”‚
  â”‚ for Claude  â”‚   â”‚ Token budgetsâ”‚   â”‚ per phase   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. SESSION START   â”‚
â”‚  (Manual or Auto)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                  â”‚                  â”‚
           â–¼                  â–¼                  â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Manual:  â”‚      â”‚ GitHub   â”‚      â”‚ Slash    â”‚
    â”‚ claude   â”‚      â”‚ Actions  â”‚      â”‚ Command  â”‚
    â”‚ --agent  â”‚      â”‚ cron â†’   â”‚      â”‚ /start-  â”‚
    â”‚ file.md  â”‚      â”‚ issue +  â”‚      â”‚ session  â”‚
    â”‚          â”‚      â”‚ @claude  â”‚      â”‚          â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚                 â”‚                 â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                 â”‚
                  â–¼                 â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
         â”‚ CLAUDE CODE    â”‚         â”‚
         â”‚ SESSION STARTS â”‚         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
                  â”‚                 â”‚
                  â–¼                 â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
         â”‚ SessionStart   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Hook Triggers  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Hook displays project context:  â”‚
    â”‚ â€¢ Complexity: 7/10               â”‚
    â”‚ â€¢ Estimated: 24 hours            â”‚
    â”‚ â€¢ Tech: React, TypeScript        â”‚
    â”‚ â€¢ Loads CLAUDE.md guidance       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. DURING SESSION  â”‚
â”‚  (Continuous)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Claude works on task â”‚
    â”‚ Uses tools: Edit,    â”‚
    â”‚ Read, Bash, etc.     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚                  â”‚                  â”‚
               â–¼                  â–¼                  â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ PreToolUse â”‚     â”‚ PostToolUseâ”‚     â”‚ Notificationâ”‚
      â”‚ Hook       â”‚     â”‚ Hook       â”‚     â”‚ Hook       â”‚
      â”‚            â”‚     â”‚            â”‚     â”‚            â”‚
      â”‚ â€¢ Track    â”‚     â”‚ â€¢ Count    â”‚     â”‚ â€¢ Desktop  â”‚
      â”‚   usage    â”‚     â”‚   tokens   â”‚     â”‚   alerts   â”‚
      â”‚ â€¢ Enforce  â”‚     â”‚ â€¢ Calc costâ”‚     â”‚ â€¢ Warnings â”‚
      â”‚   limits   â”‚     â”‚ â€¢ Update   â”‚     â”‚            â”‚
      â”‚            â”‚     â”‚   log file â”‚     â”‚            â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ session-log.json      â”‚
                    â”‚ {                     â”‚
                    â”‚   "totalTokens": 5K,  â”‚
                    â”‚   "estimatedCost": $1,â”‚
                    â”‚   "tools": {          â”‚
                    â”‚     "Edit": 42,       â”‚
                    â”‚     "Read": 18        â”‚
                    â”‚   }                   â”‚
                    â”‚ }                     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Dashboard (React)     â”‚
                    â”‚ â€¢ Watches log file    â”‚
                    â”‚ â€¢ Updates UI live     â”‚
                    â”‚ â€¢ Shows progress      â”‚
                    â”‚ â€¢ Token graphs        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. SESSION END     â”‚
â”‚  (Completion)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ SessionEnd Hook  â”‚
    â”‚ â€¢ Finalize log   â”‚
    â”‚ â€¢ Calculate      â”‚
    â”‚   final stats    â”‚
    â”‚ â€¢ Mark phase     â”‚
    â”‚   complete       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ GitHub Actions Workflow  â”‚
    â”‚ (if auto-triggered)      â”‚
    â”‚ â€¢ Close issue            â”‚
    â”‚ â€¢ Update progress        â”‚
    â”‚ â€¢ Commit changes         â”‚
    â”‚ â€¢ Trigger next phase?    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Workflow Sequence Diagram

### Full Project Lifecycle

```
Developer                 CLI                Slash Cmd           Hooks              GitHub Actions
    â”‚                     â”‚                     â”‚                  â”‚                       â”‚
    â”‚  cd project-dir     â”‚                     â”‚                  â”‚                       â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚                     â”‚                  â”‚                       â”‚
    â”‚                     â”‚                     â”‚                  â”‚                       â”‚
    â”‚  /analyze-project   â”‚                     â”‚                  â”‚                       â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚                  â”‚                       â”‚
    â”‚                     â”‚                     â”‚                  â”‚                       â”‚
    â”‚                     â”‚   Run analyzer.ts   â”‚                  â”‚                       â”‚
    â”‚                     â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚                       â”‚
    â”‚                     â”‚                     â”‚                  â”‚                       â”‚
    â”‚                     â”‚   Create files:     â”‚                  â”‚                       â”‚
    â”‚                     â”‚   â€¢ session-plan    â”‚                  â”‚                       â”‚
    â”‚                     â”‚   â€¢ CLAUDE.md       â”‚                  â”‚                       â”‚
    â”‚                     â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚                       â”‚
    â”‚                     â”‚                     â”‚                  â”‚                       â”‚
    â”‚  /create-agents     â”‚                     â”‚                  â”‚                       â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚                  â”‚                       â”‚
    â”‚                     â”‚                     â”‚                  â”‚                       â”‚
    â”‚                     â”‚   Generate 4 agents â”‚                  â”‚                       â”‚
    â”‚                     â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚                       â”‚
    â”‚                     â”‚                     â”‚                  â”‚                       â”‚
    â”‚  /setup-hooks       â”‚                     â”‚                  â”‚                       â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚                  â”‚                       â”‚
    â”‚                     â”‚                     â”‚                  â”‚                       â”‚
    â”‚                     â”‚   Install hooks     â”‚                  â”‚                       â”‚
    â”‚                     â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚                       â”‚
    â”‚                     â”‚                     â”‚                  â”‚                       â”‚
    â”‚  claude --agent     â”‚                     â”‚                  â”‚                       â”‚
    â”‚  planning-agent.md  â”‚                     â”‚                  â”‚                       â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚
    â”‚                     â”‚                     â”‚                  â”‚                       â”‚
    â”‚                     â”‚                     â”‚  SessionStart    â”‚                       â”‚
    â”‚                     â”‚                     â”‚  hook executes   â”‚                       â”‚
    â”‚                     â”‚                     â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚
    â”‚                     â”‚                     â”‚                  â”‚                       â”‚
    â”‚  [Session active]   â”‚                     â”‚                  â”‚                       â”‚
    â”‚                     â”‚                     â”‚                  â”‚                       â”‚
    â”‚                     â”‚                     â”‚  Tool hooks fire â”‚                       â”‚
    â”‚                     â”‚                     â”‚  continuously    â”‚                       â”‚
    â”‚                     â”‚                     â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚
    â”‚                     â”‚                     â”‚                  â”‚                       â”‚
    â”‚  [Complete phase]   â”‚                     â”‚                  â”‚                       â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                     â”‚                     â”‚                  â”‚   Close issue         â”‚
    â”‚                     â”‚                     â”‚                  â”‚   Update progress     â”‚
    â”‚                     â”‚                     â”‚                  â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                     â”‚                     â”‚                  â”‚                       â”‚
    â”‚                     â”‚                     â”‚                  â”‚   Trigger next phase  â”‚
    â”‚                     â”‚                     â”‚                  â”‚   (scheduled)         â”‚
    â”‚                     â”‚                     â”‚                  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚
```

---

## ğŸ“‚ File System Layout

```
your-project/
â”‚
â”œâ”€â”€ .claude/                              # Claude Code configuration
â”‚   â”‚
â”‚   â”œâ”€â”€ commands/                         # Slash commands (user-defined)
â”‚   â”‚   â”œâ”€â”€ analyze-project               # Main analysis command
â”‚   â”‚   â”œâ”€â”€ create-session-agents         # Agent generator
â”‚   â”‚   â””â”€â”€ setup-hooks                   # Hook installer
â”‚   â”‚
â”‚   â”œâ”€â”€ agents/                           # Specialized agent configs
â”‚   â”‚   â”œâ”€â”€ planning-agent.md             # Phase 1 agent
â”‚   â”‚   â”œâ”€â”€ implementation-agent.md       # Phase 2 agent
â”‚   â”‚   â”œâ”€â”€ testing-agent.md              # Phase 3 agent
â”‚   â”‚   â””â”€â”€ polish-agent.md               # Phase 4 agent
â”‚   â”‚
â”‚   â”œâ”€â”€ session-plan.json                 # Generated analysis
â”‚   â”‚   {
â”‚   â”‚     "complexity": 7,
â”‚   â”‚     "estimatedHours": 24,
â”‚   â”‚     "phases": [...],
â”‚   â”‚     "technologies": [...]
â”‚   â”‚   }
â”‚   â”‚
â”‚   â””â”€â”€ session-log.json                  # Runtime tracking
â”‚       {
â”‚         "startTime": 1234567890,
â”‚         "totalTokens": 45230,
â”‚         "estimatedCost": 2.47,
â”‚         "tools": { "Edit": 42, ... }
â”‚       }
â”‚
â”œâ”€â”€ .github/                              # GitHub Actions
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ claude-scheduler.yml          # Session scheduling
â”‚       â””â”€â”€ session-complete.yml          # Completion tracking
â”‚
â”œâ”€â”€ CLAUDE.md                             # Project guidance for Claude
â”‚   # Generated from analysis
â”‚   # Contains objectives, tech stack, risks
â”‚
â”œâ”€â”€ src/                                  # Your project code
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ node_modules/
    â””â”€â”€ claude-code-optimizer/            # NPM package
        â”œâ”€â”€ dist/
        â”‚   â”œâ”€â”€ analyzer.js               # Rule-based analyzer
        â”‚   â”œâ”€â”€ generate-claude-md.js     # CLAUDE.md generator
        â”‚   â”œâ”€â”€ create-agents.js          # Agent creator
        â”‚   â””â”€â”€ cli.js                    # CLI commands
        â”‚
        â””â”€â”€ hooks/                        # Hook templates
            â”œâ”€â”€ session-start.sh
            â”œâ”€â”€ pre-tool-use.sh
            â”œâ”€â”€ post-tool-use.sh
            â””â”€â”€ notification.sh

~/.claude/                                # Global Claude settings
â”œâ”€â”€ hooks/                                # Installed hooks
â”‚   â”œâ”€â”€ session-start.sh                  # Copied from package
â”‚   â”œâ”€â”€ pre-tool-use.sh
â”‚   â”œâ”€â”€ post-tool-use.sh
â”‚   â””â”€â”€ notification.sh
â”‚
â””â”€â”€ settings.json                         # Hook registrations
    {
      "hooks": {
        "SessionStart": "~/.claude/hooks/session-start.sh",
        "PreToolUse": "~/.claude/hooks/pre-tool-use.sh",
        "PostToolUse": "~/.claude/hooks/post-tool-use.sh"
      }
    }
```

---

## ğŸ­ Agent Specialization Flow

```
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  Project Analysis    â”‚
                        â”‚  Complexity: 7/10    â”‚
                        â”‚  Est. Time: 24 hours â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚               â”‚               â”‚
                   â–¼               â–¼               â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Planning     â”‚  â”‚ Implement    â”‚  â”‚ Testing      â”‚
         â”‚ Agent        â”‚  â”‚ Agent        â”‚  â”‚ Agent        â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚ Role:        â”‚  â”‚ Role:        â”‚  â”‚ Role:        â”‚
         â”‚ Architect    â”‚  â”‚ Developer    â”‚  â”‚ QA Engineer  â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚ Model: Opus  â”‚  â”‚ Model: Sonnetâ”‚  â”‚ Model: Sonnetâ”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚ Budget:      â”‚  â”‚ Budget:      â”‚  â”‚ Budget:      â”‚
         â”‚ 72K tokens   â”‚  â”‚ 270K tokens  â”‚  â”‚ 135K tokens  â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚ Tools:       â”‚  â”‚ Tools:       â”‚  â”‚ Tools:       â”‚
         â”‚ Read, Glob   â”‚  â”‚ Edit, Write  â”‚  â”‚ Edit, Bash   â”‚
         â”‚ Grep, Bash   â”‚  â”‚ Read, Bash   â”‚  â”‚ Read         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚ Objectives:  â”‚  â”‚ Objectives:  â”‚  â”‚ Objectives:  â”‚
         â”‚ â€¢ Architectureâ”‚ â”‚ â€¢ Features   â”‚  â”‚ â€¢ Tests      â”‚
         â”‚ â€¢ Roadmap    â”‚  â”‚ â€¢ Integrationâ”‚  â”‚ â€¢ Bug fixes  â”‚
         â”‚ â€¢ Setup      â”‚  â”‚ â€¢ Utilities  â”‚  â”‚ â€¢ Integrationâ”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚               â”‚               â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  Session Complete    â”‚
                        â”‚  â€¢ All phases done   â”‚
                        â”‚  â€¢ Tests passing     â”‚
                        â”‚  â€¢ Docs written      â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”— Hook Integration Points

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CLAUDE CODE SESSION                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                        SESSION LIFECYCLE

    START                                            END
      â”‚                                               â”‚
      â–¼                                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚SessionStart                                   â”‚SessionEndâ”‚
â”‚  Hook    â”‚                                    â”‚  Hook    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                                               â”‚
     â”‚ Inject context                                â”‚ Finalize
     â”‚ Display stats                                 â”‚ Save results
     â”‚ Initialize log                                â”‚ Calculate totals
     â”‚                                               â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Tool Execution â”‚
              â”‚   (repeated)   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚              â”‚              â”‚
        â–¼              â–¼              â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚PreToolUseâ”‚  â”‚ Tool Run â”‚  â”‚PostToolUse
  â”‚  Hook    â”‚  â”‚          â”‚  â”‚  Hook    â”‚
  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
       â”‚             â”‚             â”‚
       â”‚ Log usage   â”‚ Execute     â”‚ Count tokens
       â”‚ Check limitsâ”‚             â”‚ Update cost
       â”‚             â”‚             â”‚ Check budget
       â”‚             â”‚             â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚Notification Hookâ”‚
            â”‚  (conditional)  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”‚ Desktop alert
                      â”‚ Budget warning
                      â”‚ Milestone reached
                      â”‚
                      â–¼
              [User sees alert]
```

---

## ğŸ“Š Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CLI Command â”‚ claude-optimizer analyze ./project
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TypeScript Analyzer  â”‚
â”‚                       â”‚
â”‚  1. Scan files        â”‚â”€â”€â”€â”€â”€â”€> [file-scanner.ts]
â”‚  2. Calc complexity   â”‚â”€â”€â”€â”€â”€â”€> [Heuristics + formulas]
â”‚  3. Est. hours        â”‚â”€â”€â”€â”€â”€â”€> [Based on complexity]
â”‚  4. Generate phases   â”‚â”€â”€â”€â”€â”€â”€> [4 phases template]
â”‚                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                     â”‚                  â”‚
            â–¼                     â–¼                  â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ session-     â”‚     â”‚  CLAUDE.md   â”‚   â”‚ 4 Agent      â”‚
    â”‚ plan.json    â”‚     â”‚              â”‚   â”‚ .md files    â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                    â”‚                   â”‚
           â”‚                    â”‚                   â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚               â”‚
                        â–¼               â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
                â”‚ Claude Code  â”‚        â”‚
                â”‚ Session      â”‚        â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
                       â”‚                â”‚
                       â”‚ Uses agent â”€â”€â”€â”€â”˜
                       â”‚ Reads CLAUDE.md
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Hooks Execute   â”‚
              â”‚ During Session  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ session-log.jsonâ”‚
              â”‚ (updated live)  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Dashboard Reads â”‚
              â”‚ (file watch)    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Complete Example Flow

### Real-World Scenario

```
1. MONDAY MORNING
   â”œâ”€ Developer: /analyze-project
   â”œâ”€ Creates: session-plan.json, CLAUDE.md
   â”œâ”€ Developer: /create-session-agents
   â””â”€ Creates: 4 agent files

2. MONDAY 9 AM (GitHub Actions triggers)
   â”œâ”€ Workflow creates issue: "Planning Phase"
   â”œâ”€ Issue body: "@claude start with planning-agent.md"
   â””â”€ Claude Code detects @mention

3. CLAUDE SESSION STARTS
   â”œâ”€ SessionStart hook fires
   â”‚  â”œâ”€ Reads session-plan.json
   â”‚  â”œâ”€ Displays: "Complexity 7/10, 24 hours"
   â”‚  â””â”€ Loads CLAUDE.md guidance
   â”‚
   â”œâ”€ Planning agent loaded
   â”‚  â”œâ”€ Role: Software Architect
   â”‚  â”œâ”€ Token budget: 72,000
   â”‚  â””â”€ Objectives: [Architecture, Roadmap, Setup]
   â”‚
   â””â”€ Claude works on objectives

4. DURING SESSION (every tool use)
   â”œâ”€ PreToolUse hook: Log tool name
   â”œâ”€ Tool executes: (Edit, Read, Bash, etc.)
   â”œâ”€ PostToolUse hook:
   â”‚  â”œâ”€ Estimate tokens (+1000)
   â”‚  â”œâ”€ Update session-log.json
   â”‚  â”œâ”€ Calculate cost
   â”‚  â””â”€ Check budget (warn at 80%)
   â”‚
   â””â”€ Dashboard watches session-log.json
      â””â”€ Updates UI in real-time

5. SESSION COMPLETES
   â”œâ”€ SessionEnd hook:
   â”‚  â”œâ”€ Finalize session-log.json
   â”‚  â”œâ”€ Calculate final stats
   â”‚  â””â”€ Mark planning phase complete
   â”‚
   â”œâ”€ GitHub Actions detects completion
   â”‚  â”œâ”€ Closes issue
   â”‚  â”œâ”€ Updates progress: "1/4 phases done"
   â”‚  â””â”€ Commits session-log.json
   â”‚
   â””â”€ Notification: "Planning phase complete!"

6. TUESDAY 9 AM (Next phase auto-starts)
   â”œâ”€ GitHub Actions creates new issue
   â”œâ”€ Issue: "Implementation Phase"
   â”œâ”€ Mentions: @claude with implementation-agent.md
   â””â”€ Cycle repeats...
```

---

## ğŸ“ Key Architectural Principles

### 1. **File-Based State**
```
Why: Simple, transparent, debuggable
How: JSON files + file watching
Not: WebSockets, databases, EventEmitters
```

### 2. **Shell-Script Automation**
```
Why: Universal, maintainable, transparent
How: Bash hooks + slash commands
Not: Complex TypeScript SDK wrappers
```

### 3. **Native Integration**
```
Why: Leverage Claude Code's strengths
How: Agents, hooks, slash commands
Not: Fighting the platform
```

### 4. **GitHub as Scheduler**
```
Why: Integrated with code, free, reliable
How: Actions + cron + issues
Not: Google Calendar API polling
```

### 5. **Rule-Based Analysis**
```
Why: Fast, deterministic, always works
How: Heuristics + formulas
Not: AI API calls
```

---

This architecture is **simpler**, **more reliable**, and **easier to maintain** than the SDK approach!
